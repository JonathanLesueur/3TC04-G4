!function(e){var t={};function s(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(i,r,function(t){return e[t]}.bind(null,r));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t,s){"use strict";s.r(t);var i;s(1),s(2);(i=s(3)).keys().forEach(i)},function(e,t){class s{constructor(e){return this.loading=!1,this.options={emitter:null,request:null,method:"POST",url:"",data:{},strData:"",dataType:"json",onSuccess:null,beforeSend:null},this.init(e),this}init(e){for(var t in e)this.options.hasOwnProperty(t)&&(this.options[t]=e[t]);return this.options.request||(this.options.request=new XMLHttpRequest),this}send(e){var t=this;return e||t.buildStrData(),t.abort(),t.beforeSend(),t.options.request.open(t.options.method,t.options.url),t.options.request.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.options.request.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.options.request.send(e||t.options.strData),t.options.request.onreadystatechange=function(){4===t.options.request.readyState&&404===t.options.request.status?(t.loading=!1,console.error("AjaxRequest - Page introuvable")):4===t.options.request.readyState&&200===t.options.request.status&&(t.loading=!1,t.options.onSuccess&&t.options.onSuccess(t.options.request.response||t.options.request.responseText,t))},t}reload(){this.send()}clearDatas(){this.data={}}setDatas(e){return this.options.data=e||{},this}addData(e,t){return this.options.data[e]=t,this}removeData(e){this.options.data[e]&&delete this.options.data[e]}buildStrData(){for(var e in this.options.strData="",this.options.data)if("[object Array]"!==Object.prototype.toString.apply(this.options.data[e]))this.addDataUrl(e,this.options.data[e]);else for(var t=this.options.data[e],s=0;s<t.length;s++)this.addDataUrl(e+"[]",t[s])}addDataUrl(e,t){this.options.strData+=(this.options.strData.length>0?"&":"")+e+"="+t}beforeSend(){return this.loading=!0,this.options.beforeSend?this.options.beforeSend():null}abort(){return this.options.request&&this.options.request.abort(),this.loading=!1,this}isLoading(){return this.loading}getNbLayers(){return this.nbLayers}}class i{constructor(e){this.datas=e,this.currentTile=!1,this.tilesList=document.querySelector(".tiles-list"),this.currentCategory=!1,this.currentTheme=0}setTheme(e){this.currentTheme=e,this.resetList(),this.setCategory("default")}setCategory(e){this.currentCategory=e,this.resetList(),this.makeList()}resetList(){this.tilesList.innerHTML=""}makeList(){var e=this,t=this.datas[this.currentTheme].categorys[this.currentCategory];t&&t.assets.forEach(t=>{var s=new r(e.currentCategory,e.currentTheme,t);e.tilesList.appendChild(s.element)})}}class r{constructor(e,t,s){this.category=e,this.theme=t,this.picture=s,this.name="",this.element=!1,this.category&&this.theme&&this.picture&&this.makeTile()}makeTile(){var e=document.createElement("div");e.setAttribute("class","tile");var t=document.createElement("img");return t.setAttribute("loading","lazy"),t.setAttribute("src",`//jolstatic.fr/dofus/Modules/MapMaker/assets/category_${this.theme}/${this.category}/${this.picture}.png`),e.appendChild(t),this.element=e,this}}class n{constructor(e){this.layersList=e,this.layersView=[],this.currentLayer=1,this.nbLayers=map.getNbLayers(),this.layersList&&this.init()}init(){for(var e=this.nbLayers;e>=1;e--)this.makeLayerView(e)}makeLayerView(e){var t=document.createElement("div");t.setAttribute("class","layer");var s=document.createElement("div");s.innerText=e,s.setAttribute("class","layer-number");var i=document.createElement("div");i.setAttribute("class","layer-view");var r=document.createElement("i");return r.setAttribute("class","jol-icon jol-icon-eye"),i.appendChild(r),e==this.currentLayer&&(s.classList.add("active"),i.classList.add("active")),t.appendChild(s),t.appendChild(i),this.layersView[e]=t,this.layersList.appendChild(t),s.addEventListener("click",()=>{this.changeLayer(e)}),i.addEventListener("click",()=>{this.toggleView(e)}),t}drawLayer(e){var t=document.createElement("div");return t.setAttribute("class","layer layer_"+e),1==e&&t.classList.add("visible"),t}changeLayer(e){this.currentLayer!=e&&(this.layersView[this.currentLayer].querySelector(".layer-number").classList.remove("active"),this.layersView[e].querySelector(".layer-number").classList.add("active"),this.currentLayer=e,map.changeCurrentLayer(e))}toggleView(e){var t=this;document.querySelectorAll(".cell").forEach(s=>{s.querySelector(".layer_"+e).classList.toggle("visible"),t.layersView[e].querySelector(".layer-view").classList.toggle("active")})}}class a{constructor(){this.menuChoices=document.querySelector(".map-type-choice"),this.menuOptions=document.querySelector(".options-menus"),this.tilesContainer=document.querySelector(".tiles-container"),this.mapTypeChoices=this.menuChoices.querySelectorAll(".choice"),this.optionsButtons=document.querySelectorAll(".option-button"),this.optionsMenus=this.menuOptions.querySelectorAll(".menu"),this.menuHeader=document.querySelector(".options-menus-choices"),this.currentOption=!1,this.currentOptionMenu=!1,this.currentMapType=!1,this.currentMenu=this.menuChoices,this.menuChoices&&this.menuOptions&&this.tilesContainer&&this.mapTypeChoices&&this.optionsButtons&&this.optionsMenus&&this.menuHeader&&this.init()}init(){var e=this;this.mapTypeChoices.forEach(t=>{t.addEventListener("click",()=>{e.mapChangeType(t)})}),this.optionsButtons.forEach(t=>{t.addEventListener("click",()=>{e.optionChoice(t)})})}mapChangeType(e){var t=e.getAttribute("data-type");categorys.init(t),themes.init(),"pvp"===t?(categorys.disable(),themes.disable()):(categorys.active(),themes.active()),this.changeCurrentMenu(this.tilesContainer)}optionChoice(e){var t=this,s=e.getAttribute("data-option");this.menuOptions.classList.add("active"),this.optionsMenus.forEach(i=>{i.classList.contains(s)&&(i==t.currentOptionMenu?(t.changeCurrentMenu(t.tilesContainer),t.changeCurrentOption(e,!1)):(t.changeCurrentMenu(t.menuOptions),t.changeCurrentOption(e,i)))})}changeCurrentMenu(e){this.currentMenu.classList.remove("active"),this.currentMenu=e,this.currentMenu.classList.add("active")}changeCurrentOption(e,t){this.currentOption&&this.currentOption.classList.remove("active"),this.currentOption=e,this.currentOption.classList.add("active"),this.currentOptionMenu&&this.currentOptionMenu.classList.remove("active"),this.currentOptionMenu=t,this.currentOptionMenu.classList.add("active"),t.classList.add("active")}}class o{constructor(e,t){this.type=e,this.name=t,this.element=!1,this.type&&this.name&&this.make()}getType(){return this.type}getName(){return this.name}getElement(){return this.element}make(){var e=document.createElement("option");return e.setAttribute("value",this.type),e.innerText=this.name,"default"===this.type&&(e.selected=!0,e.setAttribute("selected","selected")),this.element=e,this}}class u{constructor(e){this.categorysInput=document.querySelector(".js-select-categorys"),this.categorys=[],this.currentCategory="default",this.currentThemeId=0,this.datas=e,this.mapType=!1,this.datas&&console.log("Categories OK")}init(e){this.mapType=e,this.categorysInput.addEventListener("change",()=>{this.changeCategory()}),this.makeCategorys()}makeCategorys(e=!1){var t;this.categorysInput.innerHTML="",t=e?this.datas[e].categorys:this.datas[this.currentThemeId].categorys;for(const[e,i]of Object.entries(t)){var s=new o(e,i.name);this.categorys.push(s),this.categorysInput.appendChild(s.getElement())}s=new o("default","Choisir une catégorie");this.categorysInput.prepend(s.element)}changeCategory(){this.currentCategory=this.categorysInput.value,tiles.setCategory(this.currentCategory)}setTheme(e){this.currentThemeId=e,this.makeCategorys(this.currentThemeId)}disable(){this.categorysInput.disabled=!0}active(){this.categorysInput.disabled=!1}}class c{constructor(e,t,s){this.id=e,this.name=t,this.desc=s,this.element=!1,this.id&&this.name&&this.desc&&this.make()}make(){var e=document.createElement("option");return e.setAttribute("value",this.id),e.innerText=this.name,this.element=e,this}getId(){return this.id}getName(){return this.name}getDesc(){return this.desc}getElement(){return this.element}}class l{constructor(e){this.themesInput=document.querySelector(".js-select-themes"),this.themes=[],this.currentTheme=0,this.datas=e,this.datas&&console.log("Themes OK")}init(){this.themesInput.addEventListener("change",()=>{this.changeTheme()}),this.makeThemes(),categorys.setTheme(this.currentTheme)}changeTheme(){this.currentTheme=this.themesInput.value,categorys.setTheme(this.currentTheme),tiles.setTheme(this.currentTheme)}makeThemes(){this.themesInput.innerHTML="";for(const[t,s]of Object.entries(this.datas)){var e=new c(t,s.name,s.desc);this.themes.push(e),this.themesInput.appendChild(e.getElement())}e=new c("default","Choisir un thème","")}disable(){this.themesInput.disabled=!0}active(){this.themesInput.disabled=!1}}class h{constructor(e){this.target=e,this.mousePosition={},this.offset=[0,0],this.isDown=!1,this.target&&this.init()}init(){this.target.addEventListener("mousedown",this.mouseDown.bind(this),!0),this.target.addEventListener("mouseup",this.mouseUp.bind(this),!0),this.target.addEventListener("mousemove",this.mouseMove.bind(this),!0),this.target.addEventListener("contextmenu",(function(e){e.preventDefault()}),!1),this.target.addEventListener("oncontextmenu",(function(){window.event.returnValue=!1}),!1)}mouseDown(e){2==e.buttons&&(this.isDown=!0,this.offset=[0-e.clientX,0-e.clientY])}mouseUp(e){this.isDown=!1}mouseMove(e){e.preventDefault(),this.isDown&&(this.mousePosition={x:e.clientX,y:e.clientY},this.target.style.left=this.mousePosition.x+this.offset[0]+"px",this.target.style.top=this.mousePosition.y+this.offset[1]+"px")}}class d{constructor(e){this.map=e,this.mapElements=[],this.nbLines=20,this.cellsByLine=20,this.currentLayer=1,this.nbLayers=10,this.isSymetric=!1,this.isPVP=!1,this.isCustom=!1,this.isDown=!1,this.datas=!1,this.map&&this.init()}init(){this.getDatas()}getDatas(){var e=this;new s({url:"https://dofus.jeuxonline.info/map-maker/getDatas",dataType:"json",data:{},onSuccess(t){var s=JSON.parse(t);e.datas=s,themes=new l(e.datas),categorys=new u(e.datas),tiles=new i(e.datas),menus=new a,layers=new n(m.layersList),e.drawMap()}}).send()}drawMap(){for(var e=0;e<=this.nbLines;e++){var t=this.drawLine(e);this.map.appendChild(t);for(var s=0;s<=this.cellsByLine;s++){var i=this.drawCell(e,s);t.appendChild(i)}this.mapElements.push(t)}}drawLine(e){var t=document.createElement("div");return t.setAttribute("class","line"),t.setAttribute("data-x",e),t}drawCell(e,t){var s=this,i=document.createElement("div");i.setAttribute("class","cell"),i.setAttribute("data-x",e),i.setAttribute("data-y",t),e%2==0?t%2==0?i.classList.add("even"):i.classList.add("odd"):t%2==0?i.classList.add("odd"):i.classList.add("even");var r=document.createElement("div");r.setAttribute("class","base"),i.appendChild(r);for(var n=1;n<=this.nbLayers+1;n++){n==this.nbLayers+1&&(n="master");var a=layers.drawLayer(n);i.prepend(a)}return i.addEventListener("mouseover",()=>{s.cellMouseHover(i)}),i.addEventListener("mouseout",()=>{s.cellMouseOut(i)}),i}cellMouseHover(e){if(e.classList.add("hover"),this.isSymetric){var t=parseInt(e.getAttribute("data-x")),s=parseInt(e.getAttribute("data-y"));this.getCell(this.nbLines-t,this.cellsByLine-s).classList.add("symetry")}}cellMouseOut(e){if(e.classList.remove("hover"),this.isSymetric){var t=parseInt(e.getAttribute("data-x")),s=parseInt(e.getAttribute("data-y"));this.getCell(this.nbLines-t,this.cellsByLine-s).classList.remove("symetry")}}getLine(e){return this.mapElements[e]}getCells(e){return this.mapElements[e].querySelectorAll(".cell")}getCell(e,t){return this.mapElements[e][t]}getNbLayers(){return this.nbLayers}changeBaseColor(e,t){this.mapElements.forEach(s=>{s.forEach(s=>{s.classList.contains(e)&&(s.style.backgroundColor=t)})})}changeCurrentLayer(e){this.currentLayer=e}toggleBorder(){this.map.classList.toggle("no-border")}}map=!1,menus=!1,categorys=!1,themes=!1,tiles=!1,layers=!1;const m={mapCover:document.querySelector(".map-cover"),mapPage:document.querySelector(".map-page"),carte:document.querySelector("#main-map"),fullScreenButton:document.querySelector(".btn-fullscreen"),layersList:document.querySelector(".map-layers")};m.carte&&(map=new d(m.carte),new h(m.mapCover)),m.fullScreenButton&&m.mapPage&&m.fullScreenButton.addEventListener("click",()=>{var e;e=(e=m.mapPage)||document.documentElement,document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)})},function(e,t,s){},function(e,t,s){var i={"./icons/burger-menu.svg":4,"./icons/cvtic.svg":8,"./icons/esu-logo-dark.svg":5,"./icons/esu-logo-light.svg":10,"./icons/export.svg":6,"./icons/heart.svg":9,"./icons/help.svg":7};function r(e){var t=n(e);return s(t)}function n(e){if(!s.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}r.keys=function(){return Object.keys(i)},r.resolve=n,e.exports=r,r.id=3},function(e,t,s){"use strict";s.r(t),t.default={id:"burger-menu-usage",viewBox:"0 0 33 25",url:s.p+"./imgs/sprite.svg#burger-menu",toString:function(){return this.url}}},function(e,t,s){"use strict";s.r(t),t.default={id:"esu-logo-dark-usage",viewBox:"0 0 2200.000000 1393.000000",url:s.p+"./imgs/sprite.svg#esu-logo-dark",toString:function(){return this.url}}},function(e,t,s){"use strict";s.r(t),t.default={id:"export-usage",viewBox:"0 0 19 19",url:s.p+"./imgs/sprite.svg#export",toString:function(){return this.url}}},function(e,t,s){"use strict";s.r(t),t.default={id:"help-usage",viewBox:"0 0 32 32",url:s.p+"./imgs/sprite.svg#help",toString:function(){return this.url}}},function(e,t,s){"use strict";s.r(t),t.default={id:"cvtic-usage",viewBox:"0 0 35 28",url:s.p+"./imgs/sprite.svg#cvtic",toString:function(){return this.url}}},function(e,t,s){"use strict";s.r(t),t.default={id:"heart-usage",viewBox:"0 0 512 512",url:s.p+"./imgs/sprite.svg#heart",toString:function(){return this.url}}},function(e,t,s){"use strict";s.r(t),t.default={id:"esu-logo-light-usage",viewBox:"0 0 2200.000000 1393.000000",url:s.p+"./imgs/sprite.svg#esu-logo-light",toString:function(){return this.url}}}]);